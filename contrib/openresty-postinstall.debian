#!/bin/sh

set -e

if [ "$1" != "configure" ]; then
    exit 0
fi

if [ -x "/etc/init.d/openresty" ]; then
    if [ -f "/var/run/openresty.pid" ] && kill -0 `cat /var/run/openresty.pid` >/dev/null; then
        /etc/init.d/openresty upgrade || true
    else
        update-rc.d openresty defaults >/dev/null
        if [ -x "`which invoke-rc.d 2>/dev/null`" ]; then
            invoke-rc.d openresty start || true
        else
            /etc/init.d/openresty start || true
        fi
    fi
fi